---
title: Traffic Charts
template: main.hbt
class: traffic
---

<script type="text/javascript">
    $(function() {

        var $body = $('div#main')
          , docWidth = $(document).width()
          , allPathData = {}
          , graphs = [];

        function dataToCsv(data) {
            var out = '';
            data.path.forEach(function(path) {
                out += path.DataAsOf + ',' + path.Speed + '\n';
            });
            return out;
        }

        $.getJSON('/paths?includeDetails=1', function(data) {
            _.each(data.paths, function(pathData, pathId) {
                var csv = '/' + pathId + '.csv'
                  , elId = 'traffic-path-' + pathId
                  , titleHtml;
                $body.append('<div id="' + elId + '" class="chart"></div>');
                titleHtml = '<a href="#' + elId +  '">'
                    + pathData.linkName + ' ('
                    + pathData.Borough + ')</a><br/>'
                    + '<a href="/' + pathId + '" target="_blank">Path ' + pathId
                    + ' Raw Data</a>';
                graphs.push(new Dygraph(document.getElementById(elId), csv, {
                    title: titleHtml
                  , width: docWidth * 0.9
                  , Speed: { axis: { } }
                }));
            });
        });

    });
</script>